https://github.com/chvinodgcp5010/vprofile-project

branch : Docker

git clone -b docker https://github.com/chvinodgcp5010/vprofile-project.git

=============================== Without multistage dockerfile ================================

FROM tomcat:8-jre11
LABEL "Project"="Vprofile"
LABEL "Author"="Imran"

RUN rm -rf /usr/local/tomcat/webapps/*
COPY target/vprofile-v2.war /usr/local/tomcat/webapps/ROOT.war

EXPOSE 8080
CMD ["catalina.sh", "run"]
WORKDIR /usr/local/tomcat/
VOLUME /usr/local/tomcat/webapps



=========================================================================================

This docker file has one problem.The problem is it's not completely automated.We have to generate the artifact in this step.

It copies the artifact.But this artifact needs to be there in this directory.We need to manually build this artifact.

We have to do MV and install which creates this artifact.And then we copy this.How about we put the MVN install command

build commands in the Dockerfile, then we don't need to do it manually right now.Sure, we can do that.


=================================== Dockerfile ===============================================

# Multistage Dockerfile

FROM openjdk:8 AS BUILD_IMAGE
RUN apt update && apt install maven -y
RUN git clone -b vp-docker https://github.com/imranvisualpath/vprofile-repo.git
RUN cd vprofile-repo && mvn install

FROM tomcat:8-jre11

RUN rm -rf /usr/local/tomcat/webapps/*

COPY --from=BUILD_IMAGE vprofile-repo/target/vprofile-v2.war /usr/local/tomcat/webapps/ROOT.war

EXPOSE 8080
CMD ["catalina.sh", "run"]

==================================================

cd git clone -b docker https://github.com/devopshydclub/vprofile-project.git
cd vprofile-project/Docker-files/app/
ls
cd multistage/
ls
cat Dockerfile
docker build -t appimg:v1 .
docker images



